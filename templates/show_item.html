{% extends "layout.html" %}

{% block title %}{{ item.title }}{% endblock %}

{% block content %}
<h2>{{ item.name }}</h2>
{% if session.user_id == item.owner_id %}
<p>
  <a href="/edit_item/{{ item.id }}">Muokkaa</a>
  <a href="/remove_item/{{ item.id }}">Poista</a>
</p>
{% endif %}
<p>
  {{ item.description }}
</p>
<p>
  Sijainti: {{ item.location }}
</p>
<p>
  Kategoria: {{ item.category }}
</p>
<p>
  Omistaja: <a href="/user/{{ item.owner_id }}">{{ item.owner_username }}</a>
</p>
{% if classes %}
<p>
  Luokat:
  <ul>
    {% for class in classes %}
    <li>{{ class.title}}: {{ class.value}}</li>
    {% endfor %}
  </ul>
</p>
{% endif %}
<hr />
<h3>Kommentit</h3>
{% if comments %}
  <ul>
    {% for comment in comments %}
      <li>
        <b>{{ comment.username }}</b> ({{ comment.created_at[:16].replace('T', ' ') }}):<br />
        {{ comment.content }}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>Ei kommentteja.</p>
{% endif %}

{% if session.user_id %}
<h4>Lisää kommentti</h4>
<form action="/add_comment" method="post">
  <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}" />
  <textarea name="content" rows="3" cols="40" required></textarea><br />
  <input type="hidden" name="restaurant_id" value="{{ item.id }}" />
  <input type="submit" value="Lähetä" />
</form>
{% else %}
  <p>Kirjaudu sisään kommentoidaksesi.</p>
{% endif %}
<p>
  <a href="/">Takaisin</a>
</p>
{% endblock %}